<!-- Your existing results HTML -->

{% if summary %}
<table class="table table-striped table-bordered table-smaller-rows">
    <!-- ... (keep the existing table content) ... -->
</table>
{% elif results %}
<div class="alert alert-danger" role="alert">
    <h4 class="alert-heading">Neverending Work Train Alert! üöÇ</h4>
    <p>Uh-oh! It looks like you're on the Neverending Work Train! Keep chugging along, or better yet, reevaluate your financial plan to hop on the Express Train to Retirement! üå¥üçπ</p>
</div>
{% endif %}

{% if results %}
<!-- Create div elements to hold the plots -->
<div id="age-vs-net-worth-plot"></div>
<div id="age-vs-monthly-safe-withdraw-plot"></div>
<div id="savings-vs-spending-plot"></div>

<!-- Add the JavaScript code to render the plots -->
<script>
    const ageVsNetWorthPlotSpec = JSON.parse({{ age_vs_net_worth_plot| tojson | safe }});
    const ageVsMonthlySafeWithdrawPlotSpec = JSON.parse({{ age_vs_monthly_safe_withdraw_plot| tojson | safe }});
    const savingsVsSpendingPlotSpec = JSON.parse({{ savings_vs_spending_plot| tojson | safe }});

    vegaEmbed("#age-vs-net-worth-plot", ageVsNetWorthPlotSpec);
    vegaEmbed("#age-vs-monthly-safe-withdraw-plot", ageVsMonthlySafeWithdrawPlotSpec);
    vegaEmbed("#savings-vs-spending-plot", savingsVsSpendingPlotSpec);
</script>

<div class="scrollable-table">
    <table class="table table-striped table-bordered table-smaller-rows">
        <!-- ... (keep the existing table content) ... -->
    </table>
</div>
{% endif %}

<script>
    // Update the URL with the new parameters
    history.pushState(null, "", "/calculate?{{ url_params | safe }}");
</script>